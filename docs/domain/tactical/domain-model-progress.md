# ドメインモデル詳細化の記録

## 格納場所
`docs/domain/tactical/domain-model-refinement.md`

## 背景
既存のドメインモデルをベースに、テストケース管理システムの詳細設計を進めるため、段階的な検討を実施。

## 検討プロセス

### 1. 状態遷移の定義
- テストケースの状態遷移フローを明確化
  ```
  作成 → テスト → 修正（繰り返し） → レビュー → 修正（繰り返し） → 完了
  ```
- 各状態での制約条件を定義
  - テスト中は実行者以外の編集を制限
  - レビュー中のテスト実行は不可
  - 完了状態からの再テストは履歴管理必須

### 2. 権限管理の設計
- 状態に応じた編集権限の制御を導入
- レビュワーの権限範囲を定義
  - レビュー中のコメント追加
  - 軽微な修正が可能
  - テスト担当者はレビューコメントへの対応のみ可能

### 3. 履歴管理の方針
- テスト実行履歴は直近10回分を保持
- 古い履歴は月次でアーカイブ
- 状態変更履歴には理由を記録可能に

### 4. スケジュール管理の簡素化
- 初期段階では以下の制約は不要と判断
  - 曜日による制限
  - 1日あたりの実施上限
- テストケースへの担当者紐付けは実装

### 5. テンプレート機能の追加
- テストスイートレベルのテンプレート化
- テストケースレベルのテンプレート化
- テンプレートからの作成機能
- テンプレート管理機能

## 更新されたドメインモデルの主な変更点
1. TestStatusの列挙型追加
2. StatusHistoryクラスの追加（状態変更履歴）
3. TestCasePermissionクラスの追加（権限管理）
4. テンプレート関連の属性とメソッド追加
5. ロック機能の追加（CurrentEditor, IsLocked）

## 次のステップ候補
1. 権限設計の詳細化
   - 状態ごとの編集可能項目の定義
   - レビュワー権限の詳細設計
2. 履歴管理の実装詳細
   - アーカイブ方式の検討
   - 検索・表示機能の設計
3. テストスイートの進捗計算ロジック
4. ガントチャートとの連携部分の詳細設計

## 検討課題として残っている事項
- 進捗計算ロジックの詳細
- アーカイブデータの保持期間
- テンプレート管理の詳細仕様

## 参照ドキュメント
- コンテキストマップ: `docs/domain/strategic/context-map.md`
- 初期ドメインモデル: `docs/domain/tactical/domain-model.md`
- プロジェクト概要: `docs/_meta/progress-summary.md`
